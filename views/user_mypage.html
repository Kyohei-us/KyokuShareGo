<!DOCTYPE html>
<html>

<head>
    <!-- Load jquery first, then bootstrap 5 -->
    <meta charset="UTF-8">
    <title>My page</title>

    <!-- Load Tailwindcss -->
    <link href="/static/output.css" rel="stylesheet">
</head>

<script>
    function editDisplayName() {
        const showDisplayNameElement = document.getElementById("showDisplayName");

        const showDisplayNameText = showDisplayNameElement.textContent;

        showDisplayNameElement.hidden = true;

        const editDisplayNameElement = document.getElementById("editDisplayName");

        editDisplayNameElement.hidden = false;

        const editDisplayNameButton = document.getElementById("editDisplayNameButton");

        editDisplayNameButton.hidden = true;

        const postEditedDisplayNameButton = document.getElementById("postEditedDisplayNameButton");

        postEditedDisplayNameButton.hidden = false;
    }

    function postEditedDisplayName() {
        const editDisplayNameText = document.getElementById("editDisplayNameInput").value;

        fetch('/session/updateDisplayName', { 
            method: 'PATCH',
            body: JSON.stringify({
            "display_name": editDisplayNameText
        }) })
            .then((response) => response.json())
            .then((data) => console.log(data))
            .catch(error => console.error(error));
        window.location.replace("/");
    }
</script>

<body class="bg-gray-800">

    {{ template "navbar" . }}

    <!-- Main contents -->
    <div class="container-fluid text-center">
        <div class="flex">

            <!-- Center area -->
            <div class="flex-1">
                <h1 class="text-center text-gray-200 text-2xl">Home page</h1>
                <div class="grid grid-cols-3 gap-4 bg-gray-800">
                    <div 
                        class="max-w-sm rounded overflow-hidden shadow-lg bg-gray-800 text-gray-100 hover:bg-gray-600 m-4">
                        <div class="px-6 py-4">
                            <h3 class="text-gray-200 font-bold text-xl mb-2">{{- .user.Email }}</h3>
                        </div>
                    </div>
                    {{ if .user.DisplayName }}
                    <div 
                        class="max-w-sm rounded overflow-hidden shadow-lg bg-gray-800 text-gray-100 hover:bg-gray-600 m-4">
                        <div id="showDisplayName" class="px-6 py-4">
                            <h3 class="text-gray-200 font-bold text-xl mb-2">{{- .user.DisplayName }}</h3>
                        </div>
                        <div id="editDisplayName" class="px-6 py-4" hidden>
                            <input id="editDisplayNameInput" class="text-gray-600 font-bold text-xl mb-2" value="{{- .user.DisplayName }}" />
                        </div>
                        <button
                            id="editDisplayNameButton"
                            onclick="editDisplayName()">Edit</button>
                        <button
                            id="postEditedDisplayNameButton"
                            onclick="postEditedDisplayName()"
                            hidden>Save Change</button>
                    </div>
                    {{ end }}
                </div>
            </div>

        </div>
    </div>

</body>
</html>